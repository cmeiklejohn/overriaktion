#!/usr/bin/env ruby

$:.push File.expand_path("../../lib", __FILE__)

require 'optparse'
require 'methadone'
require 'overriaktion'

include Methadone::Main

main do |api_key, operation, cluster_name, node_uri|
  client = lambda do
    Overriaktion::CLI.dispatch(api_key, operation, cluster_name, node_uri)
  end

  if ENV['RAILS_ENV'] == 'test'
    VCR.use_cassette('overriak') do
      client.call
    end
  else
    client.call
  end
end

description "Client gem for the Overriak service."

arg :api_key
arg :operation
arg :cluster_name, :optional
arg :node_uri, :optional

go!
